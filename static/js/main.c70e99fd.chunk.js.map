{"version":3,"sources":["components/Card/card.js","components/PostsBlock/postsBlock.js","components/FavoritedBlock/favoritedBlock.js","ApiServices/getPosts.js","cats.png","App.js","hooks/useLocalStorage.js","helpfullFunctions/debounce.js","index.js"],"names":["Card","imageSource","title","isVideo","media","preview","addToFavorite","isFavorite","deleteFromFavorite","className","poster","controls","src","reddit_video","fallback_url","alt","height","width","onClick","console","log","PostsBlock","posts","isLoaded","map","item","index","data","url","is_video","images","source","id","FavoritedBlock","length","post","getPosts","a","after","fetch","response","json","App","React","useState","setPosts","setAfter","setIsLoaded","key","initialValue","JSON","parse","localStorage","getItem","value","setValue","useEffect","setItem","stringify","useLocalStorage","favoritedPosts","setFavoritedPosts","then","res","buff","children","filter","url_overridden_by_dest","includes","catch","err","infinityScroll","contentHeight","document","querySelector","offsetHeight","yOffset","window","pageYOffset","window_height","innerHeight","Math","ceil","buffResp","f","t","debouncedScroll","args","previousCall","this","lastCall","Date","now","clearTimeout","lastCallTimer","setTimeout","addEventListener","removeEventListener","cats","findIndex","push","splice","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c70e99fd.chunk.js","sourcesContent":["import React from 'react';\r\nimport './card.css';\r\n\r\nconst Card = ({ imageSource, title, isVideo, media, preview, addToFavorite, isFavorite, deleteFromFavorite }) => {\r\n    return (\r\n        <div className=\"card-block\">\r\n            <div className=\"header-block\">\r\n                <div className=\"posted-info\"></div>\r\n                <h3 className=\"title\">{title}</h3>\r\n            </div>\r\n            <hr />\r\n            <div className=\"img-block\">\r\n                {\r\n                    isVideo ? (\r\n                        <video poster={preview} controls className=\"video-player\">\r\n                            <source src={media.reddit_video.fallback_url} />\r\n                        </video>\r\n                    ) :\r\n                        (\r\n                            <img src={`${imageSource}`} alt=\"post image\" height=\"600px\" width=\"500px\" />\r\n                        )\r\n                }\r\n            </div>\r\n            <hr />\r\n            <div className=\"favorite-block\">\r\n                {!isFavorite\r\n                    ? (\r\n                        <button\r\n                            className=\"favorite-button\"\r\n                            onClick={() => {\r\n                                console.log('added to favorite');\r\n                                addToFavorite();\r\n                            }}\r\n                        >\r\n                            <i className=\"bi bi-heart-fill\"></i>\r\n                        </button>)\r\n                    : (\r\n                        <button\r\n                            className=\"favorite-button\"\r\n                            onClick={() => {\r\n                                console.log('deleted from favorite');\r\n                                deleteFromFavorite();\r\n                            }}\r\n                        >\r\n                            <i className=\"bi bi-trash\"></i>\r\n                        </button>\r\n                    )\r\n                }\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Card;","import React from 'react';\r\nimport Card from '../Card/card';\r\n\r\nconst PostsBlock = ({posts, isLoaded, addToFavorite}) => {\r\n    return (\r\n        <div>\r\n            {\r\n                isLoaded ? (\r\n                    posts?.map((item, index) => {\r\n                        return (\r\n                            <Card\r\n                                key={item.data.id}\r\n                                imageSource={item.data.url}\r\n                                title={item.data.title}\r\n                                isVideo={item.data.is_video}\r\n                                media={item.data.media}\r\n                                preview={item.data.preview?.images[0].source.url}\r\n                                addToFavorite={() => addToFavorite(index)}\r\n                            />\r\n                        )\r\n                    })\r\n                ) : (<div>...Loaded</div>)\r\n            }\r\n        </div>\r\n    )\r\n};\r\n\r\nexport default PostsBlock;","import React from 'react';\r\nimport Card from '../Card/card';\r\nimport './favoritedBlock.css';\r\n\r\nconst FavoritedBlock = ({ posts, deleteFromFavorite, isLoaded }) => {\r\n    return (\r\n        <>\r\n            {isLoaded ? (\r\n                <div className=\"favorited-block\" >\r\n                    <h4>В избранном сейчас {posts.length}</h4>\r\n                    {\r\n                        posts?.map((post, index) => {\r\n                            return (\r\n                                <Card\r\n                                    key={post.data.id}\r\n                                    imageSource={post.data.url}\r\n                                    title={post.data.title}\r\n                                    isVideo={post.data.is_video}\r\n                                    media={post.data.media}\r\n                                    preview={post.data.preview?.images[0].source.url}\r\n                                    deleteFromFavorite={() => deleteFromFavorite(index)}\r\n                                    isFavorite={true}\r\n                                />\r\n                            )\r\n                        })\r\n\r\n                    }\r\n                </div >\r\n            ) : null}\r\n        </>\r\n    )\r\n};\r\n\r\nexport default FavoritedBlock;","const getPosts = async (after = '') => {\r\n    let url = ''\r\n    if (after) {\r\n        url = `https://www.reddit.com/r/cats/hot.json?after=${after}&raw_json=1`;\r\n    } else {\r\n        url = 'https://www.reddit.com/r/cats/hot.json?raw_json=1';\r\n    }\r\n    let response = await fetch(url)\r\n    const data = await response.json();\r\n    return data;\r\n};\r\n\r\nexport default getPosts;","export default __webpack_public_path__ + \"static/media/cats.22d978d6.png\";","import React from 'react';\nimport PostsBlock from './components/PostsBlock/postsBlock';\nimport FavoritedBlock from './components/FavoritedBlock/favoritedBlock';\nimport debounce from './helpfullFunctions/debounce';\nimport getPosts from \"./ApiServices/getPosts\";\nimport useLocalStorage from './hooks/useLocalStorage';\nimport cats from './cats.png';\nimport './App.css';\n\nconst App = () => {\n  const [posts, setPosts] = React.useState([]);\n  const [after, setAfter] = React.useState('');\n  const [isLoaded, setIsLoaded] = React.useState(false);\n  const [favoritedPosts, setFavoritedPosts] = useLocalStorage('favorite');\n\n  React.useEffect(() => {\n    const proxy = \"https://cors-anywhere.herokuapp.com/\";\n    getPosts()\n      .then((res) => {\n        let buff = res.data.children.filter((item) => {\n          if (item.data.url_overridden_by_dest && !item.data.url.includes('gallery')) {\n            return true;\n          }\n          return false;\n        });\n        console.log('after filter', buff);\n        setPosts(buff);\n        setAfter(res.data.after);\n        setIsLoaded(true);\n      }).catch((err) => console.log(err));\n  }, []);\n\n  const infinityScroll = () => {\n    let block = document.querySelector('.App');\n    let contentHeight = block.offsetHeight;      // 1) высота блока контента вместе с границами\n    let yOffset = window.pageYOffset;      // 2) текущее положение скролбара\n    let window_height = window.innerHeight;      // 3) высота внутренней области окна документа\n    let y = Math.ceil(yOffset + window_height);\n    // console.log('ch', contentHeight, ' : ', 'yOffset', yOffset);\n    // console.log('wh', window_height, ' : ', 'y', y);\n\n    // если пользователь достиг конца\n    if (y >= contentHeight - 600) {\n      //загружаем новое содержимое в элемент\n      console.log('подгружаем новые посты');\n      getPosts(after)\n        .then((res) => {\n          console.log(res.data.children);\n          let buffResp = res.data.children.filter((item) => {\n            if (item.data.url_overridden_by_dest && !item.data.url.includes('gallery')) {\n              return true;\n            }\n            return false;\n          });\n          let buff = [...posts, ...buffResp];\n          setPosts(buff);\n          setAfter(res.data.after);\n        }).catch((err) => console.log(err));\n    }\n  };\n\n  const addToFavorite = (index) => {\n    console.log(index);\n    let buff = [...favoritedPosts];\n    let inFavoritedPos = favoritedPosts?.findIndex((item) => {\n      return item.data.id === posts[index].data.id\n    });\n    if (inFavoritedPos === -1) {\n      buff.push(posts[index]);\n      setFavoritedPosts(buff);\n    }\n  };\n\n  const deleteFromFavorite = (index) => {\n    let buff = [...favoritedPosts];\n    buff.splice(index, 1);\n    setFavoritedPosts(buff);\n    // let buff = [...favoritedPosts];\n    // buff.splice(index, 1);\n    // setFavoritedPost(buff);\n  };\n\n  React.useEffect(() => {\n    let debouncedScroll = debounce(infinityScroll, 500);\n    window.addEventListener(\"scroll\", debouncedScroll);\n    return () => window.removeEventListener('scroll', debouncedScroll)\n  });\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <div className=\"header-content\">\n          <img src={cats} className=\"App-logo\" alt=\"logo\" />\n          <div className=\"header-description\">\n            <h4 className=\"header-text\">\n              Cats\n            </h4>\n            <div className=\"header-subbredit\">r/cats</div>\n          </div>\n        </div>\n      </header>\n      <div className=\"content-block\">\n        <PostsBlock posts={posts} isLoaded={isLoaded} addToFavorite={addToFavorite} />\n        <FavoritedBlock posts={favoritedPosts} deleteFromFavorite={deleteFromFavorite} isLoaded={isLoaded} />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import { useState, useEffect } from 'react';\r\n\r\nexport default (key, initialValue = '[]') => {\r\n    console.log(key, initialValue);\r\n    const [value, setValue] = useState(() => {\r\n        console.log('Is return ls item', key);\r\n        return JSON.parse(localStorage.getItem(key) || initialValue);\r\n    });\r\n\r\n    useEffect(() => {\r\n        console.log('Is set ls item', key, value);\r\n        localStorage.setItem(key, JSON.stringify(value));\r\n    }, [value, key]);\r\n\r\n    return [value, setValue]\r\n}","export default function debounce(f, t) {\r\n    return function (args) {\r\n      let previousCall = this.lastCall;\r\n      this.lastCall = Date.now();\r\n      if (previousCall && ((this.lastCall - previousCall) <= t)) {\r\n        clearTimeout(this.lastCallTimer);\r\n      }\r\n      this.lastCallTimer = setTimeout(() => f(args), t);\r\n    }\r\n};","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}